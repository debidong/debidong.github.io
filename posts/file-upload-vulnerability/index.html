<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>File Upload Vulnerability - debidong's site</title><meta name=Description content="File upload vulnerability 101"><meta property="og:title" content="File Upload Vulnerability"><meta property="og:description" content="File upload vulnerability 101"><meta property="og:type" content="article"><meta property="og:url" content="http://www.debidong.github.io/posts/file-upload-vulnerability/"><meta property="og:image" content="http://www.debidong.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-08-20T16:58:00+08:00"><meta property="article:modified_time" content="2023-08-20T16:58:00+08:00"><meta property="og:site_name" content="debidong's site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.debidong.github.io/logo.png"><meta name=twitter:title content="File Upload Vulnerability"><meta name=twitter:description content="File upload vulnerability 101"><meta name=application-name content="debidong's site"><meta name=apple-mobile-web-app-title content="debidong's site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://www.debidong.github.io/posts/file-upload-vulnerability/><link rel=prev href=http://www.debidong.github.io/posts/working-with-databases-correctly-in-django/><link rel=next href=http://www.debidong.github.io/posts/code-with-go/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"File Upload Vulnerability","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/www.debidong.github.io\/posts\/file-upload-vulnerability\/"},"genre":"posts","keywords":"cybersecurity, file upload, Django","wordcount":1236,"url":"http:\/\/www.debidong.github.io\/posts\/file-upload-vulnerability\/","datePublished":"2023-08-20T16:58:00+08:00","dateModified":"2023-08-20T16:58:00+08:00","license":"debidong","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"debidong"},"description":"File upload vulnerability 101"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="debidong's site">debidong's site</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/about/>About </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="debidong's site">debidong's site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/about/ title>About</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">File Upload Vulnerability</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=www.debidong.github.io title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>debidong</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2023-08-20>2023-08-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1236 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;6 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#1-terminology>1 Terminology</a></li><li><a href=#2-prevention-of-file-upload-vulnerabilities>2 Prevention of File Upload Vulnerabilities</a><ul><li><a href=#21-input-validation>2.1 Input Validation</a></li><li><a href=#22-isolate-uploaded-files>2.2 Isolate Uploaded Files</a></li><li><a href=#23-rename-files>2.3 Rename Files</a></li><li><a href=#24-content-detection>2.4 Content Detection</a></li></ul></li><li><a href=#3-file-upload-vulnerabilities-bypass>3 File Upload Vulnerabilities Bypass</a><ul><li><a href=#31-using-directory-traversal>3.1 Using Directory Traversal</a></li><li><a href=#32-modifying-file-mime-type>3.2 Modifying File MIME Type</a></li><li><a href=#33-bypassing-with-inclusion>3.3 Bypassing with Inclusion</a></li><li><a href=#34-using-aliases>3.4 Using Aliases</a></li><li><a href=#35-overriding-htaccess-files>3.5 Overriding <code>.htaccess</code> Files</a></li><li><a href=#36-using-obfuscated-file-extensions>3.6 Using Obfuscated File Extensions</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>This article includes the concept of <strong>file upload vulnerablity</strong>, with its precaution and bypass. There may be more than one updates of this article since there are new methodologies about prevention and exploitation coming up.</p><h2 id=1-terminology>1 Terminology</h2><p>A file upload vulnerability refers to a security flaw present in an application or website that allows attackers to perform malicious actions by uploading malicious files. Such vulnerabilities typically occur in functionalities that require users to upload files, such as image uploads, document uploads, attachments, etc. Attackers can exploit this type of vulnerability by uploading files containing malicious code, scripts, or malware, and then executing these files to compromise the security of the system.</p><p>File upload vulnerabilities may lead to the following issues:</p><ul><li><strong>Remote Code Execution</strong>: Attackers can upload files containing malicious code and then execute this code on the affected server to perform arbitrary operations, thereby gaining complete control over the server.</li><li><strong>File Overwrite</strong>: Attackers upload files with the same name as existing files, overwriting legitimate files. This may result in loss of functionality, data loss, or users being denied access to files they should be able to access.</li><li><strong>File Inclusion</strong>: Attackers upload files and attempt to include them in other parts of the application, causing the application to perform unexpected actions or disclose sensitive information.</li><li><strong>Server Denial of Service (DoS)</strong>: Attackers may upload large files that deplete server resources, rendering the server unable to process other requests.</li><li><strong>Malicious File Propagation</strong>: Attackers can upload files containing malicious software, viruses, spyware, etc., using these files to spread malicious software.</li></ul><h2 id=2-prevention-of-file-upload-vulnerabilities>2 Prevention of File Upload Vulnerabilities</h2><h3 id=21-input-validation>2.1 Input Validation</h3><p>Validate the type, size, and content of uploaded files to ensure that only allowed file types and sizes are accepted.</p><p>Here&rsquo;s a Python example of an input validation strategy. The function takes a filename and attempts to retrieve the file&rsquo;s extension. It returns a truth value when a <code>.</code> is present in the filename and the lowercase extension is within <code>ALLOWED_EXTENSIONS</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>ALLOWED_EXTENSIONS</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;jpg&#39;</span><span class=p>,</span> <span class=s1>&#39;png&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>allowed_file</span><span class=p>(</span><span class=n>filename</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;.&#39;</span> <span class=ow>in</span> <span class=n>filename</span> <span class=ow>and</span> <span class=n>filename</span><span class=o>.</span><span class=n>rsplit</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span> <span class=ow>in</span> <span class=n>ALLOWED_EXTENSIONS</span>
</span></span></code></pre></div><p>In Python, you can use <code>os.path.getsize()</code> to detect the size of a file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_file_size</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>size</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=n>file_path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>OSError</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span></code></pre></div><h3 id=22-isolate-uploaded-files>2.2 Isolate Uploaded Files</h3><p>Store uploaded files in a separate directory with restricted access to prevent execution of malicious files.</p><ul><li>Create a dedicated directory on the server for storing uploaded files, isolating it from other parts of the application.</li><li>Ensure that uploaded files do not have execute permissions to prevent attackers from attempting to execute malicious executable files.</li><li>Generate a unique filename for each uploaded file to avoid filename conflicts and overwriting.</li></ul><p>Here&rsquo;s a Django example of isolating uploaded files.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>rest_framework.parsers</span> <span class=kn>import</span> <span class=n>FileUploadParser</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>rest_framework.response</span> <span class=kn>import</span> <span class=n>Response</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>rest_framework.views</span> <span class=kn>import</span> <span class=n>APIView</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>rest_framework</span> <span class=kn>import</span> <span class=n>status</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set an isolated folder as the upload folder</span>
</span></span><span class=line><span class=cl><span class=n>UPLOAD_FOLDER</span> <span class=o>=</span> <span class=s1>&#39;uploads/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>FileUploadView</span><span class=p>(</span><span class=n>APIView</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>parser_classes</span> <span class=o>=</span> <span class=p>(</span><span class=n>FileUploadParser</span><span class=p>,)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>post</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>request</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>file</span> <span class=o>=</span> <span class=n>request</span><span class=o>.</span><span class=n>data</span><span class=p>[</span><span class=s1>&#39;file&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>file</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>UPLOAD_FOLDER</span> <span class=o>+</span> <span class=n>file</span><span class=o>.</span><span class=n>name</span><span class=p>,</span> <span class=s1>&#39;wb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>dest</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>for</span> <span class=n>chunk</span> <span class=ow>in</span> <span class=n>file</span><span class=o>.</span><span class=n>chunks</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=n>dest</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=n>chunk</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>status</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_201_CREATED</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>Response</span><span class=p>(</span><span class=n>status</span><span class=o>=</span><span class=n>status</span><span class=o>.</span><span class=n>HTTP_400_BAD_REQUEST</span><span class=p>)</span>
</span></span></code></pre></div><p>On Linux, you can use <code>chmod</code> to remove the execute and read/write permissions of files in a directory.</p><h3 id=23-rename-files>2.3 Rename Files</h3><p>Assign randomly generated names to uploaded files to prevent attackers from overwriting legitimate files or accessing webshells by predicting filenames.</p><p>As an example using Python&rsquo;s <code>random.choice()</code>, generate a random string.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>string</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>random_string</span><span class=p>(</span><span class=n>length</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>letters</span> <span class=o>=</span> <span class=n>string</span><span class=o>.</span><span class=n>ascii_letters</span> <span class=o>+</span> <span class=n>string</span><span class=o>.</span><span class=n>digits</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>(</span><span class=n>letters</span><span class=p>)</span> <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>length</span><span class=p>))</span>
</span></span></code></pre></div><h3 id=24-content-detection>2.4 Content Detection</h3><p>Scan uploaded files to detect the presence of malicious code.</p><p>ClamAV is a commonly used open-source antivirus scanning engine used to detect malicious code and viruses. When dealing with executing external commands, handling processes, etc., using <code>subprocess</code> is a common and recommended practice, as it provides a convenient interface for interacting with system processes, facilitating error handling, and ensuring a certain level of security.</p><p>Use the <code>subprocess.run()</code> function to start a new subprocess, executing specific external commands or programs. Communicate with subprocesses via channels such as standard input (stdin), standard output (stdout), and standard error (stderr).</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>scan_file_with_clamav</span><span class=p>(</span><span class=n>file_path</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=o>=</span> <span class=n>subprocess</span><span class=o>.</span><span class=n>run</span><span class=p>([</span><span class=s1>&#39;clamscan&#39;</span><span class=p>,</span> <span class=s1>&#39;--stdout&#39;</span><span class=p>,</span> <span class=s1>&#39;-i&#39;</span><span class=p>,</span> <span class=n>file_path</span><span class=p>],</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>output</span> <span class=o>=</span> <span class=n>result</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=s2>&#34;OK&#34;</span> <span class=ow>in</span> <span class=n>output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=s2>&#34;FOUND&#34;</span> <span class=ow>in</span> <span class=n>output</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>None</span>
</span></span><span class=line><span class=cl>    <span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>None</span>
</span></span></code></pre></div><h2 id=3-file-upload-vulnerabilities-bypass>3 File Upload Vulnerabilities Bypass</h2><p>Certain conditions need to be met for a file upload vulnerability to be exploitable. The uploaded file must be interpreted and executed by the web container, and the directory where the file is uploaded must be within the web container&rsquo;s covered path. Users must be able to access the uploaded file via the web; if they can&rsquo;t, or if the web container can&rsquo;t interpret scripts, the attack might fail.</p><p>There are generally two ways for server-side validation of file types:</p><ul><li>Directly reading the file extension.</li><li>Parsing the file header information.</li></ul><h3 id=31-using-directory-traversal>3.1 Using Directory Traversal</h3><p>Construct a fuzzy directory traversal sequence to upload a file to the parent folder.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>filename=&#34;..%2fexploit.php&#34;
</span></span></code></pre></div><h3 id=32-modifying-file-mime-type>3.2 Modifying File MIME Type</h3><p>Use Burp Suite to modify the <code>Content-Type</code> field value. For example, change the MIME type of a file in a POST request body to <code>Content-Type: image/jpeg</code>.</p><p>Common MIME types:</p><pre tabindex=0><code>text/plain
text/html
text/javascript
application/xhtml+xml
image/gif
image/jpeg
image/png
video/mpeg
application/octet-stream
application/pdf
application/(programming language) (code in that language)
application/msword
message/rfc822
multipart/alternative
application/x-www-form-urlencoded
multipart/form-data
</code></pre><h3 id=33-bypassing-with-inclusion>3.3 Bypassing with Inclusion</h3><p>When a Web Application Firewall (WAF) only checks for a Trojan horse in specific file types (e.g., <code>.php</code> or <code>.jsp</code>), this method can be used.</p><ol><li>Upload a TXT file named <code>shell.txt</code> containing Trojan content. Due to the file type, the server-side won&rsquo;t check it.</li><li>Upload a PHP file with content <code>&lt;?php include(".￼shell.txt");?></code>. Visiting this PHP file will reference the Trojan.</li></ol><h3 id=34-using-aliases>3.4 Using Aliases</h3><ul><li>Change <code>.php</code> to <code>.php5</code>.</li><li>Change <code>.html</code> to <code>.shtml</code>.</li></ul><p>This can bypass less strict blacklist filtering.</p><h3 id=35-overriding-htaccess-files>3.5 Overriding <code>.htaccess</code> Files</h3><p><code>.htaccess</code> is a configuration file for the Apache Web server. It allows site administrators to define rules and settings in the root or specific directories to control website behavior and access permissions. These rules can include redirects, authentication, access control, cache settings, etc.</p><ul><li><p><code>SetHandler</code> directive assigns a handler to specific file extensions or types, enforcing a specific method of handling for matched files.</p><pre tabindex=0><code>SetHandler handler-name
</code></pre></li><li><p><code>AddType</code> directive associates a media type (MIME type) with specific file extensions, allowing browsers to correctly display or process files.</p><pre tabindex=0><code>AddType media-type extension
</code></pre></li><li><p><code>php_flag</code> sets PHP engine configuration options. Setting the engine value to <code>off</code> or <code>0</code> can disable PHP parsing in the current directory and its subdirectories, potentially leading to source code exposure.</p><pre tabindex=0><code>php_flag engine 0
</code></pre></li></ul><h3 id=36-using-obfuscated-file-extensions>3.6 Using Obfuscated File Extensions</h3><ul><li><p>Concatenate multiple extensions: <code>shell.php.php</code>.</p></li><li><p>Append characters: <code>shell.php.</code>.</p></li><li><p>Append a space: <code>shell.php </code>.</p></li><li><p>URL-encode the <code>.</code> character: <code>shell%2Ephp</code>.</p></li><li><p>Null byte bypass: <code>shell.asp%00.jpg</code>.</p><blockquote><p><strong>Null Byte</strong></p><p>A null byte is used as a string terminator in some programming languages and operating systems, which could cause certain handling functions to incorrectly truncate strings, leading to security vulnerabilities. When an attacker inserts <code>%00</code> into a filename, the server might mistakenly truncate the filename, causing the uploaded file type and location to differ from expectations, potentially bypassing certain security checks.</p></blockquote></li><li><p>Semicolon bypass: <code>shell.asp;.jpg</code>.</p><p>In some applications, semicolons might be used as separators between parameters or parameter values, such as in URL parameters or certain scripts. Attackers might attempt to insert semicolons in inputs to separate multiple parameters or values, disrupting the application&rsquo;s parsing logic.</p></li><li><p>Use multi-byte Unicode characters.</p></li><li><p>Double-write bypass: <code>shell.p.phphp</code>.</p><p>In this payload, <code>.php</code> might be filtered, leaving just <code>shell.php</code>.</p></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2023-08-20</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=http://www.debidong.github.io/posts/file-upload-vulnerability/ data-title="File Upload Vulnerability" data-hashtags="cybersecurity,file upload,Django"><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=http://www.debidong.github.io/posts/file-upload-vulnerability/ data-hashtag=cybersecurity><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=http://www.debidong.github.io/posts/file-upload-vulnerability/ data-title="File Upload Vulnerability"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=http://www.debidong.github.io/posts/file-upload-vulnerability/ data-title="File Upload Vulnerability"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=http://www.debidong.github.io/posts/file-upload-vulnerability/ data-title="File Upload Vulnerability"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/cybersecurity/>cybersecurity</a>,&nbsp;<a href=/tags/file-upload/>file upload</a>,&nbsp;<a href=/tags/django/>Django</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/working-with-databases-correctly-in-django/ class=prev rel=prev title="Working With Databases Correctly in Django"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Working With Databases Correctly in Django</a>
<a href=/posts/code-with-go/ class=next rel=next title="Code With Go">Code With Go<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=www.debidong.github.io target=_blank>debidong</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>